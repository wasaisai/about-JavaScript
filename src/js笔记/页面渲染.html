<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>diagrams.net</title>
<meta http-equiv="refresh" content="0;URL='https://app.diagrams.net/#Hwasaisai%2Fabout-JavaScript%2Fmain%2Fsrc%2Fjs%E7%AC%94%E8%AE%B0%2F%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93.html'"/>
<meta charset="utf-8"/>
</head>
<body>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2022-04-11T01:35:06.571Z\&quot; agent=\&quot;5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36\&quot; etag=\&quot;3CbzMlJzv4o7Rwm8y9QI\&quot; version=\&quot;17.4.1\&quot; type=\&quot;github\&quot;&gt;&lt;diagram id=\&quot;UPNhk-mzLneH_ZWtLLcc\&quot; name=\&quot;Page-1\&quot;&gt;&lt;mxGraphModel dx=\&quot;3711\&quot; dy=\&quot;1838\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;&lt;root&gt;&lt;mxCell id=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-1\&quot; value=\&quot;\&quot; style=\&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.rect;fillColor2=none;strokeWidth=1;size=20;indent=5;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;40\&quot; y=\&quot;70\&quot; width=\&quot;1160\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-2\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#ffffff&amp;quot; style=&amp;quot;font-size: 20px&amp;quot;&amp;gt;浏览器&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;50\&quot; y=\&quot;70\&quot; width=\&quot;110\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-17\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;fontColor=#990099;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-3\&quot; target=\&quot;CZpBsIKWZBwA8OBQ3vFL-14\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-3\&quot; value=\&quot;&amp;lt;div&amp;gt;主进程&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;align=center;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;200\&quot; y=\&quot;80\&quot; width=\&quot;70\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-89\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-5\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-82\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;625\&quot; y=\&quot;390\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-5\&quot; value=\&quot;渲染进程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;642.5\&quot; y=\&quot;190\&quot; width=\&quot;70\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-6\&quot; value=\&quot;网络进程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;430\&quot; y=\&quot;-20\&quot; width=\&quot;70\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-7\&quot; value=\&quot;插件进程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;840\&quot; y=\&quot;85\&quot; width=\&quot;70\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-11\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-8\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-2\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;270\&quot; y=\&quot;60\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-14\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#990099&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;在地址栏中输入url&amp;lt;/font&amp;gt;\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;VEFvD20xZ57EE92ImBKW-11\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;&lt;mxGeometry x=\&quot;-0.5397\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;22\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-8\&quot; value=\&quot;\&quot; style=\&quot;shape=actor;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-180\&quot; y=\&quot;-60\&quot; width=\&quot;40\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-18\&quot; value=\&quot;\&quot; style=\&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.rect;fillColor2=none;strokeWidth=1;size=20;indent=5;fillColor=#e1d5e7;strokeColor=#9673a6;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;210\&quot; y=\&quot;470\&quot; width=\&quot;930\&quot; height=\&quot;545\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-137\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-19\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-72\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-19\&quot; value=\&quot;JS引擎线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;450\&quot; y=\&quot;1096.25\&quot; width=\&quot;80\&quot; height=\&quot;157.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-20\&quot; value=\&quot;事件触发线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;560\&quot; y=\&quot;1097.5\&quot; width=\&quot;80\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-21\&quot; value=\&quot;定时触发线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;780\&quot; y=\&quot;1097.5\&quot; width=\&quot;80\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-142\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.823;entryY=0.671;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-22\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-105\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;y9lzXUGiLXLAUCWp2xjQ-6\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.524;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-22\&quot; target=\&quot;y9lzXUGiLXLAUCWp2xjQ-4\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-22\&quot; value=\&quot;异步http请求线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;910\&quot; y=\&quot;1096.25\&quot; width=\&quot;80\&quot; height=\&quot;156.25\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-24\&quot; value=\&quot;GUI渲染线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;670\&quot; y=\&quot;1097.5\&quot; width=\&quot;80\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-28\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 11px ; line-height: 1.7&amp;quot; color=&amp;quot;#990099&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(0 , 0 , 0) ; font-size: 11px ; text-align: center&amp;quot;&amp;gt;处理请求:&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;1. 查找缓存&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;2.&amp;amp;nbsp; DNS解析,如果请求协议是HTTPS, 需要建立TLS连接&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;3. 准备IP、端口号&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;4. 等待TCP队列&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;5. 建立TCP连接&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;6. 构建请求行、请求头等信息, 并把和该域名相关的cookie等数据附加到请求头中&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;7. 发送HTTP请求&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;8.服务器处理&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;9. 服务器响应&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;10 断开连接&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;249.54\&quot; y=\&quot;-420\&quot; width=\&quot;440.46\&quot; height=\&quot;225\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-33\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-6\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-28\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;600\&quot; y=\&quot;90\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;700\&quot; y=\&quot;-10\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-34\&quot; value=\&quot;2.&amp;lt;br&amp;gt;处理请求\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;472.5\&quot; y=\&quot;-140\&quot; width=\&quot;20\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-35\&quot; value=\&quot;3.&amp;lt;br&amp;gt;返回响应头\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;440\&quot; y=\&quot;-150\&quot; width=\&quot;10\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-38\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-3\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-6\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;600\&quot; y=\&quot;110\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;700\&quot; y=\&quot;10\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-56\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0000FF;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-39\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-55\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-39\&quot; value=\&quot;GPU进程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1050\&quot; y=\&quot;80\&quot; width=\&quot;70\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-40\&quot; value=\&quot;1.IPC发起url请求\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=-30;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;314\&quot; y=\&quot;120\&quot; width=\&quot;100\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-41\&quot; value=\&quot;4.返回响应头信息\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=-30;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;289.33\&quot; y=\&quot;77.5\&quot; width=\&quot;100\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-50\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-24\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;710\&quot; y=\&quot;1891.2500000000005\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;631.25\&quot; y=\&quot;760\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-54\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-55\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;900\&quot; y=\&quot;895\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;mxPoint x=\&quot;840\&quot; y=\&quot;1940.0645161290322\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-55\&quot; value=\&quot;6. 栅格化: 位图\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1181\&quot; y=\&quot;1910\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-59\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#cc00cc&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px&amp;quot;&amp;gt;提交文档:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt; 浏览器进程将网络进程接收到的HTML数据提交给渲染进程, 具体流程:&amp;amp;nbsp;&amp;lt;br&amp;gt;1. 当浏览器进程接收到网络进程的响应头数据之后, 便向渲染进程发起“提交文档”的消息&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#cc00cc&amp;quot;&amp;gt;2. 渲染进程接收到“提交文档”的消息后, 会和网络进程建立数据传输的管道&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#cc00cc&amp;quot;&amp;gt;3. 等文档传输完成后, 渲染进程会返回“确认提交”的消息给浏览器进程&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#cc00cc&amp;quot;&amp;gt;4. 浏览器进程在收到“确认提交”的消息后, 会更新浏览器界面状态,&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#cc00cc&amp;quot;&amp;gt;包括安全状态、地址栏的URL、前进后退的历史状态, 并更新web页面&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;173\&quot; y=\&quot;250\&quot; width=\&quot;480\&quot; height=\&quot;210\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-12\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=21;fontColor=#FF33FF;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-72\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-74\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-72\&quot; value=\&quot;&amp;lt;div style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;span&amp;gt;1. 编译阶段: 变量提升、词法环境、作用域链、原型链&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;span&amp;gt;2. 执行阶段: 执行上下文、调用栈、this&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;span style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#333333;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-220\&quot; y=\&quot;1146.25\&quot; width=\&quot;360\&quot; height=\&quot;57.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-74\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px&amp;quot;&amp;gt;词法作用域:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;amp;nbsp; 指作用域是由代码中函数声明的位置来决定的, 所以词法作用域是静态的作用域, 通过它就能够预测代码在执行过程中如何查找标示符&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;词法作用域是代码编译阶段就决定好的, 和函数怎么调用的没有关系&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-898.5\&quot; y=\&quot;1125.63\&quot; width=\&quot;500\&quot; height=\&quot;97.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-77\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px&amp;quot;&amp;gt;作用域链:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt; 通过作用域查找变量的链条称为作用域链;作用域链是通过词法作用域来确定的&amp;lt;br&amp;gt;, 而词法作用域反应了代码结构&amp;lt;br&amp;gt;每个执行上下文的变量环境中, 都包含了一个外部引用, 用来指向外部的执行上下文, 我们把这个外部引用称为&amp;lt;b&amp;gt;outer&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-901.5\&quot; y=\&quot;1223.13\&quot; width=\&quot;500\&quot; height=\&quot;90\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-78\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 18px&amp;quot;&amp;gt;this:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt; this是和执行上下文绑定的&amp;lt;br&amp;gt;1. 全局执行上下文中的this:&amp;amp;nbsp; &amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;默认情况下调用一个函数, 其上下文中的this默认指向window&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;在全局函数中调用一个函数, 函数内部的this指向的是全局变量window&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;2. 函数执行上下文中的this:&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;通过函数的call、bind、apply方法设置函数执行上下文的this指向&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;&amp;amp;nbsp;通过对象调用方法设置: 使用对象调用其内部的一个方法, 该方法的this是指向对象本身的&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;通过构造函数中设置&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;3. 嵌套函数中的this不会从外层函数中继承&amp;lt;br&amp;gt;4. 箭头函数没有自己的执行上下问, 所以箭头函数的this, 就是他外层函数的this&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-904.5\&quot; y=\&quot;1313.13\&quot; width=\&quot;503\&quot; height=\&quot;237.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-119\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-82\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-120\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1380\&quot; y=\&quot;577.5\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-4\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-82\&quot; target=\&quot;O2kx36fP5mptwlrAFMa2-1\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-82\&quot; value=\&quot;渲染主线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;275\&quot; y=\&quot;525\&quot; width=\&quot;805\&quot; height=\&quot;105\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-90\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;strokeColor=#1A1A1A;exitX=0.504;exitY=0.004;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-18\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-82\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;470\&quot; y=\&quot;580\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;520\&quot; y=\&quot;530\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-121\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;entryX=-0.003;entryY=0.6;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-94\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-122\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1390\&quot; y=\&quot;723\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-6\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-94\&quot; target=\&quot;6mHsUZAtfTJd8j0tiDtR-5\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-94\&quot; value=\&quot;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;277.5\&quot; y=\&quot;670\&quot; width=\&quot;805\&quot; height=\&quot;105\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-95\&quot; value=\&quot;消息队列\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;240\&quot; y=\&quot;660\&quot; width=\&quot;15\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-96\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#cc0000&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;添加任务&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;321.5\&quot; y=\&quot;705\&quot; width=\&quot;40\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-97\&quot; value=\&quot;任务五\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;407.5\&quot; y=\&quot;690\&quot; width=\&quot;85\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-98\&quot; value=\&quot;任务四\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;522.5\&quot; y=\&quot;690\&quot; width=\&quot;85\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-99\&quot; value=\&quot;任务三\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;635\&quot; y=\&quot;690\&quot; width=\&quot;85\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-100\&quot; value=\&quot;任务一\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;852.5\&quot; y=\&quot;690\&quot; width=\&quot;85\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-101\&quot; value=\&quot;任务二\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;747.5\&quot; y=\&quot;690\&quot; width=\&quot;85\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-102\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#cc0000&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;取出任务&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;987.5\&quot; y=\&quot;705\&quot; width=\&quot;40\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-105\&quot; value=\&quot;\&quot; style=\&quot;html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;direction=east;notch=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;275\&quot; y=\&quot;830\&quot; width=\&quot;820\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-106\&quot; value=\&quot;IO线程\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;240\&quot; y=\&quot;975\&quot; width=\&quot;40\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-109\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;strokeColor=#1A1A1A;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.262;entryY=0.686;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-19\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-105\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;500\&quot; y=\&quot;1005\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;490\&quot; y=\&quot;890\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-112\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;strokeColor=#1A1A1A;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.528;entryY=0.729;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-105\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;709.5\&quot; y=\&quot;1096.25\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;709.5799999999999\&quot; y=\&quot;998.02\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-113\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;strokeColor=#1A1A1A;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.4;entryY=0.7;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-105\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;599.5\&quot; y=\&quot;1096.25\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;599.5799999999999\&quot; y=\&quot;998.02\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-114\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;strokeColor=#1A1A1A;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.456;entryY=1.013;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-139\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;819.5\&quot; y=\&quot;1096.25\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;819.5799999999999\&quot; y=\&quot;998.02\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-117\&quot; value=\&quot;\&quot; style=\&quot;html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.bendArrow;dy=15;dx=38;notch=0;arrowHead=55;rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;314\&quot; y=\&quot;735\&quot; width=\&quot;100\&quot; height=\&quot;115\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-118\&quot; value=\&quot;\&quot; style=\&quot;html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.bendArrow;dy=15;dx=38;notch=0;arrowHead=55;rounded=1;direction=north;fillColor=#d5e8d4;strokeColor=#82b366;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;935\&quot; y=\&quot;620\&quot; width=\&quot;115\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-124\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#990099&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;执行完后如何安全退出&amp;lt;/font&amp;gt;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-120\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1840\&quot; y=\&quot;578\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-120\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;主线程的for循环代码块中, 从消息队列中读取一个任务, 然后执行该任务, 主线程就这样一直循环往下执行, 因此只要消息队列中有任务, 主线程就会去执行&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;当循环系统在执行一个任务的时候, 都要为这个任务维护一个系统调用栈.&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;每个任务在执行的时候都有自己的调用栈, 那么, 异步回调&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1370\&quot; y=\&quot;380\&quot; width=\&quot;280\&quot; height=\&quot;216.88\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-126\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-122\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1840\&quot; y=\&quot;712.5\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-127\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#990099&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;如何解决高优先级任务&amp;lt;/font&amp;gt;\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;VEFvD20xZ57EE92ImBKW-126\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;&lt;mxGeometry x=\&quot;-0.2\&quot; y=\&quot;2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;20\&quot; y=\&quot;2\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-133\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1A1A1A;entryX=0;entryY=0.75;entryDx=0;entryDy=0;exitX=0.421;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-122\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-131\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1500\&quot; y=\&quot;950\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-134\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#990099&amp;quot; style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;如何解决单个任务执行时长过久&amp;lt;/font&amp;gt;\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;VEFvD20xZ57EE92ImBKW-133\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;&lt;mxGeometry x=\&quot;0.0616\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-122\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;div style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;span&amp;gt;任务类型: 输入事件(鼠标滚动、点击、移动)、微任务、文件读写、&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;span&amp;gt;websocket、JavaScrit执行、解析DOM、样式计算、布局计算、css动画等&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1360\&quot; y=\&quot;660\&quot; width=\&quot;280\&quot; height=\&quot;105\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-125\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;确定要退出当前页面时, 页面主线程会设置一个退出标志的变量, 在每次执行完一个任务时, 判断是否有设置退出标志&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1840\&quot; y=\&quot;545\&quot; width=\&quot;240\&quot; height=\&quot;65\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-128\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;如果dom发生变化, 采用同步通知的方式, 会影响当前任务的执行效率;采用异步的方式, 又会影响到监控的实时性.&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;通常我们把消息队列中的任务称为&amp;lt;b&amp;gt;宏任务&amp;lt;/b&amp;gt;, 每个宏任务中都包含了一个微任务队列, 在执行宏任务的过程中, 如果dom有变化, 那么就会将该变化添加到&amp;lt;b&amp;gt;微任务列表&amp;lt;/b&amp;gt;中, 这样就不会影响到宏任务的继续执行, 因此解决了执行效率的问题&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1840\&quot; y=\&quot;640\&quot; width=\&quot;310\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-131\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;div style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;因为所有的任务都是在单线程中执行的, 所以每次只能执行一个任务, 而其他任务就都处于等待状态. 如果其中一个任务执行时间过久, 那么下一个任务就要等待很长时间.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;Javascript可以通过回调功能来规避这种问题, 也就是让要执行的Javascript任务滞后执行.&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1840\&quot; y=\&quot;822.5\&quot; width=\&quot;280\&quot; height=\&quot;177.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-143\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.661;entryY=0.752;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-139\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-18\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-149\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.452;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#CC0066;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-139\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-150\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1350\&quot; y=\&quot;1050\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-139\&quot; value=\&quot;延迟队列\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;750\&quot; y=\&quot;930\&quot; width=\&quot;150\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-146\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;strokeColor=#1A1A1A;\&quot; parent=\&quot;1\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;819.5\&quot; y=\&quot;1420\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;819.5\&quot; y=\&quot;1257.5\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;y9lzXUGiLXLAUCWp2xjQ-1\&quot; value=\&quot;注意事项\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-148\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;875\&quot; y=\&quot;1659.9999999999995\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-148\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;Javascript调用setTimeout设置回调函数的时候, 渲染进程将会创建一个回调任务,包含: 回调函数, 当前发起时间、延迟执行时间等.&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;创建好回调任务后, 再将该任务添加到延迟执行队列&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#333333;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;735\&quot; y=\&quot;1420\&quot; width=\&quot;280\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;VEFvD20xZ57EE92ImBKW-150\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;处理完消息队列中的任务后, 会执行processLadyTask函数. processLadyTask函数会根据发起时间和延迟时间计算出到期任务, 然后依次执行这些到期的任务. 等到期任务执行完成之后, 再继续下一个循环过程.&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1340\&quot; y=\&quot;1050\&quot; width=\&quot;310\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;y9lzXUGiLXLAUCWp2xjQ-2\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;1. 如果当前任务执行时间过久, 会影响定时器任务的执行&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;2. 如果setTimeout存在嵌套, 那么系统会设置最短时间间隔4ms&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;3. 未激活的页面, setTimeout执行最小间隔是1000ms&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;4. 延时执行时间有最大值&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;5. 使用setTimeout设置的回调函数中的this不符合直觉&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;735\&quot; y=\&quot;1660\&quot; width=\&quot;380\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;y9lzXUGiLXLAUCWp2xjQ-4\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;XMLTttpResuest提供了从web服务器获取数据的能力, 可从服务器直接获取数据, 然后再操作DOM来更新页面内容, 整个过程只需要更新网页的一部分就可以了, 不用刷新整个页面&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ol style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;创建XMLHttpResuest对象&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;为xhr对象注册回调函数&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;配置基础的请求信息&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;发起请求&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ol&amp;gt;&amp;lt;div style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;XMLTttpRequest发起请求, 是由浏览器的其他进程或者线程去执行, 然后再将执行结果利用IPC的方式通知渲染进程, 之后渲染进程再将对应的消息添加到消息队列中.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1340\&quot; y=\&quot;1260\&quot; width=\&quot;370\&quot; height=\&quot;250\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;y9lzXUGiLXLAUCWp2xjQ-5\&quot; value=\&quot;&amp;lt;p style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;回调函数&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;: 将一个函数作为参数传递给另外一个函数, 那作为参数的这个函数就是回调函数&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 13px&amp;quot;&amp;gt;&amp;lt;b&amp;gt;同步回调: &amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;font-size: 13px&amp;quot;&amp;gt;回调函数callback在主函数返回之前执行; 在当前回调函数的上下文中执行回调函数&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: left ; line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 14px&amp;quot;&amp;gt;异步回调:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt; callback并没有在主函数内部被调用, 我们把这种回调函数在主函数外部执行的过程称为异步回调, 一般有两种方式:&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;第一种: 把异步任务做成一个宏任务, 添加到消息队列尾部&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;text-align: left&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;第二种是把异步函数添加到微任务队列中,这样就可以在当前任务的末尾处执行微任务&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-903\&quot; y=\&quot;1550.63\&quot; width=\&quot;503\&quot; height=\&quot;212.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;O2kx36fP5mptwlrAFMa2-1\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px&amp;quot;&amp;gt;主线程中执行的任务:&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;渲染事件(解析DOM、计算布局、绘制)、&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;用户交互事件(如鼠标滚动、滚动页面、放大缩小等)、&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;Javascript脚本执行事件、&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;网络请求、&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;文件读写完成事件&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-120\&quot; y=\&quot;498.75\&quot; width=\&quot;330\&quot; height=\&quot;157.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;O2kx36fP5mptwlrAFMa2-2\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;宏任务的时间粒度比较大, 执行的时间间隔是不能精确控制的, 对一些高实时性的需求不太符合, 比如监听dom变化&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;微任务:&amp;lt;/b&amp;gt; 是一个需要异步执行的函数, 执行时机是在主函数执行结束之后, 当前宏任务结束之前&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;b&amp;gt;微任务系统如何运转:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;span&amp;gt;当JavaScript执行一段脚本的时候, V8会为其创建一个全局执行上下文, 在创建全局执行上下文的同时, V8引擎会在内部创建一个微任务队列. 顾名思义, 这个微任务队列就是用来存放微任务的, 因为在当前宏任务执行的过程中, 有时候会产生多个微任务, 这时候就需要使用这个微任务队列来保存这些微任务了. 不过这个微任务队列是给V8引擎内部使用的, 所以是无法通过JavaScript直接访问的&amp;lt;/span&amp;gt;&amp;amp;nbsp;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;产生微任务的两种方式:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;监听dom节点, 并通过javascript来修改、添加、删除dom节点, 当dom节点发生变化时, 就会产生dom变化记录的微任务&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;使用promise, 当调用promise.resolve()或者promise.reject()的时候, 会产生微任务&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;微任务何时被执行:&amp;lt;/b&amp;gt;&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;li&amp;gt;通常情况下, 在当前宏任务中的javascript快执行完成时, 也就在javascript引擎准备退出全局执行上下文并清空调用栈的时候, javascript引擎会检查全局执行上下文中的微任务队列, 然后按照顺序执行队列中的微任务.&amp;amp;nbsp;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;如果在执行微任务的过程中, 产生了新的微任务, 同样会将该微任务添加到微任务队列中, V8引擎一直循环执行微任务队列中的任务, 直到队列为空才算执行结束. 也就是说在执行微任务过程中产生的新的微任务并不会推迟到下个宏任务中执行, 而是在当前的宏任务中继续执行&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;微任务和宏任务:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;ul style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;li&amp;gt;微任务和宏任务式绑定的, 每个宏任务在执行的时候, 都会创建自己的微任务队列&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;微任务的执行时长影响当前宏任务的时长&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;在一个宏任务中, 分别创建一个用于回调的宏任务和微任务, 无论什么情况下, 微任务都早于宏任务执行&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-1960\&quot; y=\&quot;640\&quot; width=\&quot;613\&quot; height=\&quot;512.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;O2kx36fP5mptwlrAFMa2-3\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;b&amp;gt;观察者设计模式:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ul style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;li&amp;gt;Mutation Event: 当dom有变动时就会立刻触发相应的事件, 这种方式属于同步回调;解决了实时性的问题, 但也正是这种实时性造成了严重的性能问题, 因为每次DOM变动, 渲染引擎都会去调用Javascript, 这样会产生较大的性能开销.&amp;amp;nbsp;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;Mutation Observer: 微了解决Mutation Event由于同步调用Javascript而造成的性能问题, 从DOM4开始, 推荐使用MutationObserver来代替Mutation Event. MutationObserver API可以用来监视DOM的变化, 包括属性的变化、节点的增减、内容的变化等&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;div style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;MutationObserver将响应函数改成异步调用, 可以不用在每次DOM变化都触发异步调用, 而是等多次DOM变化后, 一次触发异步调用, 并且还会使用一个数据结构来记录这期间所有的DOM变化. 这样即使频繁地操纵DOM, 也不会对性能造成太大的影响.&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;MutationObserver采用了异步 + 微任务的策略&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;通过异步操作解决了同步操作的性能问题&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;通过微任务解决了实时性的问题&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-413\&quot; y=\&quot;3270\&quot; width=\&quot;613\&quot; height=\&quot;320\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-8\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;6mHsUZAtfTJd8j0tiDtR-5\&quot; target=\&quot;6mHsUZAtfTJd8j0tiDtR-7\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-5\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;span&amp;gt;页面进程引入消息队列和事件循环机制, 渲染进程内部会维护多个消息队列,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;span&amp;gt;比如延迟执行队列和普通的消息队列.&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;span&amp;gt;然后主线程采用一个for循环, 不断地从这些任务队列中取出任务并执行任务. 我们把消息队列中的任务称为&amp;lt;/span&amp;gt;&amp;lt;b&amp;gt;宏任务&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#666666;fillColor=#f5f5f5;fontColor=#333333;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-401.5\&quot; y=\&quot;662.5\&quot; width=\&quot;610\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-13\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=21;fontColor=#FF33FF;\&quot; parent=\&quot;1\&quot; source=\&quot;6mHsUZAtfTJd8j0tiDtR-7\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-1350\&quot; y=\&quot;723\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-7\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 21.6px&amp;quot;&amp;gt;&amp;lt;b&amp;gt;事件循环机制:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 21.6px&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;ul style=&amp;quot;line-height: 21.6px&amp;quot;&amp;gt;&amp;lt;li&amp;gt;先从多个消息队列中选出一个最老的任务, 这个任务称为oldesTask&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;然后循环系统记录任务开始执行的时间, 并把这个oldestTask设置为当前正在执行的任务&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;当任务执行完成之后, 删除当前正在执行的任务, 并从对应的消息队列中删除掉这个oldestTask&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;最后统计执行完成的时长等信息&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#666666;fillColor=#f5f5f5;fontColor=#333333;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-1020\&quot; y=\&quot;647.5\&quot; width=\&quot;550\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;6mHsUZAtfTJd8j0tiDtR-10\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;rounded=0;fontSize=21;fontColor=#FF33FF;entryX=0.403;entryY=-0.001;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-5\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-1\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;587.5\&quot; y=\&quot;150\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;687.5\&quot; y=\&quot;50\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-7\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 11px ; line-height: 1.5&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span&amp;gt;1.&amp;amp;nbsp; DNS数据缓存、页面资源缓存; 浏览器通过响应头中的Cache-Control字段来设置是否缓存该资源. 通常还需要为这个资源设置一个缓存过期时长Max-age: Cache-Control: Max-age=2000&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 11px&amp;quot;&amp;gt;如果资源过期了, 浏览器则会继续发起网络请求, 并在HTTP请求头中带上: If-None-Match: &amp;quot;xxxxxx&amp;quot;; 服务器会根据If-None—Match的值来判断请求的资源是否有更新. 如果没有更新返回304, 缓存可以继续使用; 如果更新了服务器直接返回最新资源给浏览器.&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;708.13\&quot; y=\&quot;-480\&quot; width=\&quot;423.75\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-8\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 13px ; line-height: 1.7&amp;quot; color=&amp;quot;#990099&amp;quot;&amp;gt;TCP/IP作传输层协议&amp;lt;br&amp;gt;HTTP协议作应用层协议&amp;lt;br&amp;gt;HTTP内容是通过TCP的传输数据阶段来实现的&amp;lt;span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1166\&quot; y=\&quot;-440\&quot; width=\&quot;744\&quot; height=\&quot;190\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-9\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px ; line-height: 1.5&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;9. 一旦服务器向客户端返回了请求数据, 就要关闭TCP连接, 如果浏览器或者服务器在其头部信息中加入了: Connection: Keep-alive&amp;amp;nbsp; 那么TCP连接在发送后任然保持打开状态&amp;lt;br&amp;gt;保持TCP连接可以省去下次请求时需要建立连接的时间, 提升资源加载速度.&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;708.13\&quot; y=\&quot;-230\&quot; width=\&quot;433.75\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-12\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px ; line-height: 1.7&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot; style=&amp;quot;font-size: 12px ; line-height: 1&amp;quot;&amp;gt;3. HTTP网络请求的第一步是做什么呢?和服务器建立TCP连接, 建立连接的第一步是获取IP和端口号; 第一步浏览器会请求DNS返回域名对应的IP, 接下来再获取端口号, 如果URL没有特别指明端口号, 那么HTTP协议默认是80端口&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;4.同一个域名同时最多只能建立6个TCP&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(153 , 0 , 153)&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;712.5\&quot; y=\&quot;-340\&quot; width=\&quot;411\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-14\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;用户交互、子进程管理、文件存储等功能&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-200\&quot; y=\&quot;130\&quot; width=\&quot;230\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-18\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;面向渲染进程和浏览器进程等提供网络下载功能&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;505\&quot; y=\&quot;30\&quot; width=\&quot;270\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;CZpBsIKWZBwA8OBQ3vFL-19\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;主要职责是把从网络下载的HTML、js、css、图片等资源&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;解析为可以显示和交互的页面&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;解析资源是从接收到content-type字段开始,&amp;amp;nbsp;&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;line-height: 180%&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot;&amp;gt;Content-Type告诉浏览器服务器返回的响应体数据类型是什么类型&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;712.5\&quot; y=\&quot;250\&quot; width=\&quot;360\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-1\&quot; value=\&quot;\&quot; style=\&quot;shape=flexArrow;endArrow=classic;startArrow=classic;html=1;rounded=0;fontSize=21;fontColor=#FF33FF;entryX=1;entryY=0.75;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;VEFvD20xZ57EE92ImBKW-5\&quot; target=\&quot;VEFvD20xZ57EE92ImBKW-3\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; height=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;405.02\&quot; y=\&quot;305.00060934007746\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;270.00000000000045\&quot; y=\&quot;149.99999999999994\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-2\&quot; value=\&quot;5.提交导航\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=10;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;364\&quot; y=\&quot;230\&quot; width=\&quot;100\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-3\&quot; value=\&quot;6.建立数据传输管道\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=45;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;504.99999999999994\&quot; y=\&quot;150\&quot; width=\&quot;115\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-4\&quot; value=\&quot;7. 确认提交\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=10;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;389.33\&quot; y=\&quot;200\&quot; width=\&quot;100\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-5\&quot; value=\&quot;7. 数据传输\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=45;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;542.5\&quot; y=\&quot;120\&quot; width=\&quot;100\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;GIM9M7l5qdx84Ut0ew-N-6\&quot; value=\&quot;8.更新浏览器界面状态\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;194\&quot; y=\&quot;215\&quot; width=\&quot;120\&quot; height=\&quot;20\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;QF1QNpNJstVPT3PZpu_T-1\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 2.2&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;浏览器的页面实际上被分成了很多图层, 这些图层叠加后合成了最终的页面&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;并不是布局树的每个节点都包含一个图层, 如果一个节点没有对应的层, 那么这个节点就从属于父节点的图层&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 12px ; line-height: 1.6&amp;quot; color=&amp;quot;#000099&amp;quot;&amp;gt;通常满足一下两点中的一点的元素就可以被提升为单独的一个图层&amp;lt;br&amp;gt;1. 拥有层叠上下文属性的元素: position值为absolute、fixed; flex; grid; opacity;值不为auto, transform、filter、 perspective、clio-path、mask/mask-image/mask-border值不为none&amp;lt;br&amp;gt;2. 需要裁剪(clip)的地方: 例如div大小限定为200*200, 需要显示的问题会超出200*200的面积, 这时候就产生了裁剪, 渲染引擎会把裁剪文字内容的一部分用于显示在div区域&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;在完成图层树的构建之后, 渲染引擎会对图层树中的每个图层进行绘制; 渲染引擎会把一个图层的绘制拆分成很多小的绘制指令, 然后再把这些指令按照顺序组成一个待绘制列表.&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;绘制列表只是用来记录绘制顺序和绘制指令的列表, 而实际上绘制操作是由渲染引擎中的合成线程来完成的.&amp;amp;nbsp;&amp;amp;nbsp;&amp;lt;br&amp;gt;当图层的绘制列表准备好之后, 主线程会把该绘制列表提交给合成线程&amp;lt;br&amp;gt;合成线程会将图层划分为图块, 然后合成线程会按照视口附近的图块来优先生成位图, 实际生成位图的操作是由栅格化来执行的. 所谓栅格化, 是指将图块转换为位图.&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;font color=&amp;quot;#000099&amp;quot;&amp;gt;transform可以避开重排和重绘&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-66\&quot; y=\&quot;1710\&quot; width=\&quot;480\&quot; height=\&quot;370\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;QF1QNpNJstVPT3PZpu_T-2\&quot; value=\&quot;&amp;lt;p style=&amp;quot;line-height: 2.2&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;span style=&amp;quot;font-family: &amp;amp;#34;pingfang sc&amp;amp;#34; , &amp;amp;#34;avenir&amp;amp;#34; , &amp;amp;#34;tahoma&amp;amp;#34; , &amp;amp;#34;arial&amp;amp;#34; , &amp;amp;#34;lantinghei sc&amp;amp;#34; , &amp;amp;#34;microsoft yahei&amp;amp;#34; , &amp;amp;#34;hiragino sans gb&amp;amp;#34; , &amp;amp;#34;microsoft sans serif&amp;amp;#34; , &amp;amp;#34;wenquanyi micro hei&amp;amp;#34; , &amp;amp;#34;helvetica&amp;amp;#34; , sans-serif ; background-color: rgb(255 , 255 , 255) ; line-height: 1.2&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#990099&amp;quot; style=&amp;quot;font-size: 12px ; line-height: 1.6&amp;quot;&amp;gt;1. 渲染进程将 HTML 内容转换为能够读懂的 DOM 树结构。&amp;lt;br&amp;gt;2. 渲染引擎将 CSS 样式表转化为浏览器可以理解的 styleSheets，计算出 DOM 节点的样式。&amp;lt;br&amp;gt;3. 创建布局树，并计算元素的布局信息。&amp;lt;br&amp;gt;4. 对布局树进行分层，并生成分层树。&amp;lt;br&amp;gt;5. 为每个图层生成绘制列表，并将其提交到合成线程。&amp;lt;br&amp;gt;6. 合成线程将图层分成图块，并在光栅化线程池中将图块转换成位图。&amp;lt;br&amp;gt;7. 合成线程发送绘制图块命令 DrawQuad 给浏览器进程。&amp;lt;br&amp;gt;8. 浏览器进程根据 DrawQuad 消息生成页面，并显示到显示器上。&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;477\&quot; y=\&quot;1900\&quot; width=\&quot;363\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;&lt;/diagram&gt;&lt;/mxfile&gt;&quot;,&quot;toolbar&quot;:&quot;pages zoom layers lightbox&quot;,&quot;page&quot;:0}"></div>
<a style="position:absolute;top:50%;left:50%;margin-top:-128px;margin-left:-64px;" href="https://app.diagrams.net/#Hwasaisai%2Fabout-JavaScript%2Fmain%2Fsrc%2Fjs%E7%AC%94%E8%AE%B0%2F%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93.html" target="_blank"><img border="0" src="https://app.diagrams.net/images/drawlogo128.png"/></a>
</body>
</html>
