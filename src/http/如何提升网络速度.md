### HTTP/1.1的主要问题

1. 对带宽的利用率不理想
带宽是指每秒最大能发送或者接收的字节数. 我们把每秒能发送的最大字节数称为上行带宽, 每秒能够接收的最大的最大字节数称为下行带宽.  
主要由以下三个原因导致:  
- TCP慢启动: 一旦一个TCP连接建立之后, 就进入了发送给数据状态, 刚开始TCP协议会采用一个非常慢的速度去发送数据, 然后慢慢加快发送数据的速度,直到发送数据的速度达到一个理想状态, 我们把这个过程称为慢启动.  
慢启动是TCP为了减少网络拥塞的一种策略;  
慢启动会带来性能问题, 是因为页面中常用的一些关键资源文件不大, 如HTML、css、js文件, 通常这些文件在TCP建立连接之后就要发起请求, 但这个过程是慢启动, 所以耗费的时间比正常的时间要多得多, 这样就推迟了宝贵的首次渲染页面的时长.  

2. 同时开启了多条TCP连接, 那么这些连接会竞争固定的带宽.  
    系统同时建立了多条TCP连接, 当带宽充足时, 每条连接发送或者接收速度会慢慢增加; 而一旦带宽不足时, 这些TCP连接又会减慢发送或者接收的速度.   
    这样就会出现一个问题, 因为有的TCP连接下载的是一些关键资源, 如css文件、js文件等, 而有的TCP连接下载的是图片、视频等普通的资源文件, 但是多条TCP连接之间又不能协商让那些关键资源优先下载, 这样就有可能影响那些关键资源的下载速度了.  
3. HTTP/1.1队头阻塞的问题.  

### HTTP/2的多路复用   
HTTP2的思路是一个域名只使用一个TCP长连接来传输数据, 这样整个页面资源的下载过程只需要一次慢启动, 同时也避免了多个TCP连接竞争宽带所带来的问题.  
等待请求完成后才能去请求下一个资源(队头阻塞), 这种方式无疑是最慢的, 所以HTTP/2需要实现资源的并行请求, 也就是任何时候都可以将请求发送给服务器, 而并不需要等待其他请求的完成, 然后服务器也可以随时返回处理好的请求资源给浏览器.  

**HTTP/2的解决方案可以总结为: 一个域名只使用一个TCP长连接和消除队头阻塞问题.**  

HTTP/2使用了多路复用技术, 可以将请求分成一帧一帧的数据去传输, 这样带来了一个额外的好处, 就是当收到一个优先级高的请求时, 比如接收到js或者css关键资源的请求, 服务器可以暂停之前的请求来优先处理关键资源的请求.  

HTTP/2的请求和接收过程: 
- 浏览器准备好请求数据, 包括请求行、请求头等信息. 如果是POST方法, 那么还要有请求体.  
- 这些数据经过二进制分帧层处理之后 , 会被转换为一个个带有请求ID编号的帧, 通过协议栈将这些帧发送给服务器.  
- 服务器接收到所有帧之后, 会将处理的响应行、响应头和响应体分别发送至二进制分帧层.  
- 同样, 二进制分帧层会将这些响应转换为一个个带有请求ID编号的帧, 经过协议栈发送给浏览器.  
- 浏览器接收到响应帧之后, 会根据ID编号将帧的数据提交给对应的请求.  

**通过引入二进制分帧层, 就实现了HTTP的多路复用技术**

### HTTP/2的其他特性
1. 可以设置请求优先级
2. 服务器推送
当用户请求一个HTML页面之后, 服务器知道该HTML页面会引用几个重要的js文件和css文件, 那么在接收到HTML请求之后, 附带将要使用的css文件和js文件一并发送给浏览器, 这样当浏览器解析完HTML文件之后, 就能直接拿到需要的css文件和js文件, 这对首次打开页面的速度起到了至关重要的作用.  
3. 头部压缩  


